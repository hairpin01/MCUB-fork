:root {
  --accent:      #7c3aed;
  --accent-glow: #5b21b6;
  --accent-soft: rgba(124,58,237,.18);

  --bg:       #0d0d12;
  --bg2:      #13131a;
  --card:     rgba(20,18,30,.72);
  --border:   rgba(124,58,237,.22);
  --text:     #e8e6f0;
  --text-dim: #6b6880;
  --input-bg: rgba(10,8,18,.7);
  --glow-col: #4c1d95;
  --err-bg:   rgba(127,29,29,.35);
  --err-border:rgba(239,68,68,.4);
  --err-text: #fca5a5;
}
[data-theme="light"] {
  --bg:       #f0eefa;
  --bg2:      #e8e2f7;
  --card:     rgba(255,255,255,.85);
  --border:   rgba(124,58,237,.3);
  --text:     #1e1a2e;
  --text-dim: #8b80a8;
  --input-bg: rgba(255,255,255,.9);
  --glow-col: #c4b5fd;
  --err-bg:   rgba(254,226,226,.8);
  --err-border:rgba(239,68,68,.5);
  --err-text: #b91c1c;
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}

html,body{
  width:100%;height:100%;
  background:var(--bg);
  color:var(--text);
  font-family:Hubballi,sans-serif;
  transition:background .4s,color .4s;
}

.blob{
  position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 60% 50% at 50% 60%, var(--glow-col) 0%, transparent 70%);
  opacity:.55;
  transition:background .5s;
}

.lights{
  position:fixed;inset:0;z-index:1;pointer-events:none;overflow:hidden;
  animation:fi .8s ease forwards .5s;opacity:0;
}
.light{
  position:absolute;width:3px;background:#fff;
  top:100vh;left:0;right:0;bottom:0;margin:auto;
  filter:blur(4px);
}
.x1{filter:blur(3px);animation:floatUp 4s infinite linear;}
.x2{filter:blur(3px);animation:floatUp 7s infinite linear;transform:scale(1.6);left:15%;}
.x3{filter:blur(3px);animation:floatUp 2.5s infinite linear;transform:scale(.5);left:-15%;}
.x4{filter:blur(5px);animation:floatUp 4.5s infinite linear;transform:scale(1.2);left:-34%;}
.x5{filter:blur(6px);animation:floatUp 8s infinite linear;transform:scale(2.2);left:-57%;}
.x6{filter:blur(4px);animation:floatUp 3s infinite linear;transform:scale(.8);left:-81%;}
.x7{filter:blur(3px);animation:floatUp 5.3s infinite linear;transform:scale(3.2);left:37%;}
.x8{filter:blur(6px);animation:floatUp 4.7s infinite linear;transform:scale(1.7);left:62%;}
.x9{filter:blur(3px);animation:floatUp 4.1s infinite linear;transform:scale(.9);left:85%;}

@keyframes floatUp{
  0%{top:100vh;opacity:0;}25%{opacity:1;}50%{top:0;opacity:.8;}75%{opacity:1;}100%{top:-100vh;opacity:0;}
}
@keyframes fi{to{opacity:1;}}

@keyframes slideOut {
  to {
    opacity: 0;
    transform: translateX(-18px);
  }
}
#sky{position:fixed;inset:0;overflow:hidden;z-index:1;pointer-events:none;}
#shootingstars{
  position:fixed;overflow:hidden;
  width:150vh;height:100vw;
  transform:translateX(calc(50vw - 50%)) translateY(calc(50vh - 50%)) rotate(120deg);
}
.wish{
  height:2px;width:100px;top:300px;
  position:absolute;opacity:0;
  background:linear-gradient(-45deg,#fff,rgba(0,0,255,0));
  filter:drop-shadow(0 0 6px #fff);
}
.theme-toggle{
  position:fixed;top:18px;right:18px;z-index:999;
  width:38px;height:38px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:50%;
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  font-size:1.1rem;
  backdrop-filter:blur(8px);
  transition:border-color .2s,box-shadow .2s,background .3s;
  user-select:none;
}
.theme-toggle:hover{
  border-color:var(--accent);
  box-shadow:0 0 14px -4px var(--accent);
}

#toasts{
  position:fixed;top:18px;left:18px;z-index:9999;
  display:flex;flex-direction:column;gap:8px;
  max-width:340px;
}
.toast{
  display:flex;align-items:flex-start;gap:10px;
  padding:11px 14px;
  background:var(--err-bg);
  border:1px solid var(--err-border);
  border-radius:7px;
  backdrop-filter:blur(10px);
  font-family:'JetBrains Mono',monospace;
  font-size:.76rem;
  color:var(--err-text);
  line-height:1.45;
  animation:slideIn .25s ease;
  cursor:pointer;
}
.toast.ok{
  background:rgba(5,46,22,.4);
  border-color:rgba(34,197,94,.4);
  color:#86efac;
}
.toast-icon{flex-shrink:0;margin-top:1px;}
.toast-close{margin-left:auto;flex-shrink:0;opacity:.5;padding-left:6px;}
@keyframes slideIn{from{opacity:0;transform:translateX(-18px);}to{opacity:1;transform:none;}}
@keyframes slideOut{to{opacity:0;transform:translateX(-18px);}}

.page{
  min-height:100vh;
  display:flex;flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:30px 16px 40px;
  position:relative;z-index:2;
}

.logo-row{
  display:flex;align-items:center;gap:14px;
  margin-bottom:6px;
}
.logo-img{
    height:2rem;
    width:auto;
    object-fit:contain;
}
.logo-text{
  font-family:'JetBrains Mono',monospace;
  font-size:2rem;font-weight:600;
  letter-spacing:.18em;
  color:var(--accent);
  text-shadow:0 0 24px var(--accent);
}
.subtitle{
  font-size:.88rem;color:var(--text-dim);
  text-align:center;margin-bottom:18px;
}

.steps-bar{
  display:flex;align-items:center;
  justify-content:center;
  margin-bottom:18px;
}
.step{display:flex;flex-direction:column;align-items:center;gap:3px;opacity:.35;transition:opacity .25s;}
.step.active,.step.done{opacity:1;}
.snum{
  width:28px;height:28px;border-radius:50%;
  border:1px solid var(--text-dim);color:var(--text-dim);
  display:flex;align-items:center;justify-content:center;
  font-family:'JetBrains Mono',monospace;font-weight:600;font-size:.78em;
  transition:background .25s,border-color .25s,color .25s;
}
.step.active .snum{background:var(--accent);border-color:var(--accent);color:#fff;box-shadow:0 0 12px var(--accent);}
.step.done   .snum{background:#16a34a;border-color:#16a34a;color:#fff;}
.slabel{font-size:.65em;color:var(--text-dim);white-space:nowrap;}
.step.active .slabel,.step.done .slabel{color:var(--text);}
.sconn{flex:1;height:1px;background:var(--border);min-width:28px;margin-bottom:14px;}

.wizard-card{
  width:100%;max-width:460px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:28px 30px;
  backdrop-filter:blur(12px);
  box-shadow:0 8px 48px -12px rgba(124,58,237,.25);
  transition:background .3s,border-color .3s;
}
.wstep h2{font-size:1.25rem;color:var(--text);margin-bottom:5px;}
.hint{font-size:.83rem;color:var(--text-dim);line-height:1.55;margin-bottom:18px;}
.hint a{color:var(--accent);text-decoration:none;}
.hint.small{font-size:.76rem;}

label{
  display:flex;flex-direction:column;gap:5px;
  margin-bottom:13px;
  font-family:'JetBrains Mono',monospace;
  font-size:.75rem;color:var(--text-dim);letter-spacing:.04em;
}
input[type=text],input[type=tel],input[type=password]{
  width:100%;padding:9px 12px;
  background:var(--input-bg);
  border:1px solid var(--border);
  border-radius:5px;
  color:var(--text);
  font-family:'JetBrains Mono',monospace;font-size:.9rem;
  outline:none;
  transition:border-color .2s,box-shadow .2s,background .3s;
}
input:focus{
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-soft);
}
input::placeholder{color:var(--text-dim);opacity:.55;}

.btn-primary{
  width:100%;padding:10px 16px;
  background:transparent;
  color:var(--accent);
  border:1px solid var(--accent);
  border-radius:6px;
  font-family:'JetBrains Mono',monospace;font-size:.88rem;
  cursor:pointer;
  transition:background .2s,color .2s,box-shadow .2s,transform .1s;
  margin-top:0;
  white-space:nowrap;
}
.btn-primary:hover:not(:disabled){
  background:var(--accent);color:#fff;
  box-shadow:0 0 20px -6px var(--accent);
}
.btn-primary:active:not(:disabled){ transform:scale(.97); }
.btn-primary:disabled{opacity:.35;cursor:not-allowed;}

.btn-ghost{
  width:100%;padding:10px 16px;
  background:transparent;color:var(--text-dim);
  border:1px solid var(--border);border-radius:6px;
  font-family:'JetBrains Mono',monospace;font-size:.88rem;
  cursor:pointer;transition:border-color .2s,color .2s,transform .1s;
  white-space:nowrap;
}
.btn-ghost:hover{ border-color:var(--text-dim);color:var(--text); }
.btn-ghost:active{ transform:scale(.97); }

.btn-row{ display:flex; gap:8px; margin-top:8px; }
.btn-row > button { flex:1; margin:0; }

.wstep > .btn-primary,
.wstep > .btn-ghost { margin-bottom:8px; }

.done-icon{font-size:2.8rem;text-align:center;margin-bottom:6px;}
.spinner{
  width:30px;height:30px;
  border:2px solid var(--border);border-top-color:var(--accent);
  border-radius:50%;animation:spin .7s linear infinite;margin:14px auto;
}
@keyframes spin{to{transform:rotate(360deg);}}

.reset-bar{
  font-family:'JetBrains Mono',monospace;
  font-size:.68rem;color:var(--text-dim);
  text-align:center;margin-bottom:12px;
}
.reset-link{color:var(--text-dim);text-decoration:none;transition:color .2s;}
.reset-link:hover{color:var(--accent);}

.setup-footer{
  margin-top:18px;
  font-size:.72rem;color:var(--text-dim);
  font-family:Hubballi;
}

.hidden{display:none!important;}

.page { animation: pageFadeUp .55s cubic-bezier(.22,1,.36,1) both; }
@keyframes pageFadeUp {
  from { opacity:0; transform:translateY(22px); }
  to   { opacity:1; transform:none; }
}

.wizard-card { animation: cardPop .5s cubic-bezier(.22,1,.36,1) .1s both; }
@keyframes cardPop {
  from { opacity:0; transform:scale(.96) translateY(12px); }
  to   { opacity:1; transform:none; }
}

.wstep { animation: stepIn .32s cubic-bezier(.22,1,.36,1) both; }
@keyframes stepIn {
  from { opacity:0; transform:translateX(18px); }
  to   { opacity:1; transform:none; }
}
.wstep.slide-back { animation: stepInBack .32s cubic-bezier(.22,1,.36,1) both; }
@keyframes stepInBack {
  from { opacity:0; transform:translateX(-18px); }
  to   { opacity:1; transform:none; }
}

.logo-img {
  animation: logoPulse 3s ease-in-out infinite;
  filter: drop-shadow(0 0 0px var(--accent));
}
@keyframes logoPulse {
  0%,100% { filter: drop-shadow(0 0 4px var(--accent)) drop-shadow(0 0 0px var(--accent-glow)); }
  50%      { filter: drop-shadow(0 0 14px var(--accent)) drop-shadow(0 0 8px var(--accent-glow)); }
}

.step.active .snum { animation: dotBounce .35s cubic-bezier(.34,1.56,.64,1); }
@keyframes dotBounce {
  from { transform: scale(.6); }
  to   { transform: scale(1); }
}

.sconn { position:relative; overflow:hidden; }
.sconn::after {
  content:''; position:absolute; inset:0;
  background:var(--accent);
  transform:scaleX(0); transform-origin:left;
  transition:transform .4s ease;
}
.sconn.filled::after { transform:scaleX(1); }

.blob { animation: blobDrift 8s ease-in-out infinite alternate; }
@keyframes blobDrift {
  from { background-position: 40% 55%; transform: scale(1); }
  to   { background-position: 60% 65%; transform: scale(1.06); }
}

@keyframes inputShake {
  0%,100% { transform:none; }
  20%     { transform:translateX(-6px); }
  40%     { transform:translateX(6px); }
  60%     { transform:translateX(-4px); }
  80%     { transform:translateX(4px); }
}
input.shake { animation: inputShake .4s ease; border-color: rgba(239,68,68,.8) !important; }

.done-icon img { animation: successBounce .6s cubic-bezier(.34,1.56,.64,1) .1s both; }
@keyframes successBounce {
  from { transform:scale(0) rotate(-20deg); opacity:0; }
  to   { transform:scale(1) rotate(0); opacity:1; }
}

#resetModal { transition: opacity .2s; }
#resetModal > div { animation: modalPop .25s cubic-bezier(.22,1,.36,1); }
@keyframes modalPop {
  from { transform:scale(.92); opacity:0; }
  to   { transform:none; opacity:1; }
}

#qr-image { animation: qrFadeIn .4s ease .1s both; }
@keyframes qrFadeIn {
  from { opacity:0; transform:scale(.9); }
  to   { opacity:1; transform:none; }
}

#qr-image.refreshed { animation: qrFadeIn .3s ease both; }

.btn-primary, .btn-ghost {
  position: relative; overflow: hidden;
}
.ripple {
  position:absolute; border-radius:50%;
  background:rgba(255,255,255,.25);
  transform:scale(0);
  animation:rippleAnim .5s linear;
  pointer-events:none;
}
@keyframes rippleAnim {
  to { transform:scale(4); opacity:0; }
}

#reauthPage .wizard-card { animation: cardPop .5s cubic-bezier(.22,1,.36,1) .15s both; }

@media(max-width:520px){
  .wizard-card{padding:20px 16px;}
  .slabel{display:none;}
  .sconn{min-width:16px;}
}

@keyframes shoot{0%{opacity:0;transform:translateX(0);}10%{opacity:1;}80%{opacity:.6;}100%{opacity:0;transform:translateX(-800px);}}
